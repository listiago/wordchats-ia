name: ðŸš€ Deploy to Hostinger

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: ðŸ“¥ Checkout code
      uses: actions/checkout@v4

    - name: ðŸ” Setup SSH
      run: |
        mkdir -p ~/.ssh/
        echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
        chmod 600 ~/.ssh/id_rsa
        ssh-keyscan -H ${{ secrets.SSH_HOST }} -p ${{ secrets.SSH_PORT }} >> ~/.ssh/known_hosts

    - name: ðŸ“¤ Deploy to Hostinger
      run: |
        echo "ðŸš€ Iniciando deploy..."

        # Criar diretÃ³rios remotos
        ssh -p ${{ secrets.SSH_PORT }} ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }} << EOF
          mkdir -p public_html/css
          mkdir -p public_html/js
          echo "ðŸ“ DiretÃ³rios criados"
        EOF

        # Upload dos arquivos essenciais
        echo "ðŸ“¤ Enviando arquivos..."

        scp -P ${{ secrets.SSH_PORT }} index.html ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/
        scp -P ${{ secrets.SSH_PORT }} .htaccess ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/
        scp -P ${{ secrets.SSH_PORT }} logo.png ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/
        scp -P ${{ secrets.SSH_PORT }} favicon.ico ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/
        scp -P ${{ secrets.SSH_PORT }} favicon-16x16.jpg ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/
        scp -P ${{ secrets.SSH_PORT }} favicon-32x32.jpg ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/
        scp -P ${{ secrets.SSH_PORT }} css/style.css ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/css/
        scp -P ${{ secrets.SSH_PORT }} js/main.js ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }}:public_html/js/

        echo "âœ… Arquivos enviados!"

        # Verificar deploy
        ssh -p ${{ secrets.SSH_PORT }} ${{ secrets.SSH_USER }}@${{ secrets.SSH_HOST }} << EOF
          echo "ðŸ” Verificando arquivos:"
          ls -la public_html/
          echo ""
          echo "ðŸ“ CSS:"
          ls -la public_html/css/
          echo ""
          echo "ðŸ“ JS:"
          ls -la public_html/js/
        EOF

    - name: ðŸŽ‰ Deploy Complete
      run: |
        echo "âœ… Deploy concluÃ­do com sucesso!"
        echo "ðŸŒ Site atualizado automaticamente"
